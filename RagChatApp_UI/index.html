<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG Chat App</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üìö RAG Chat Application</h1>
            <p>Carica documenti e chatta con l'AI utilizzando il contenuto come contesto</p>
        </header>

        <!-- Tab Navigation -->
        <nav class="tab-navigation">
            <button class="tab-btn active" data-tab="documents">
                üìÑ Gestione Documenti
            </button>
            <button class="tab-btn" data-tab="chat">
                üí¨ Chat AI
            </button>
        </nav>

        <!-- Documents Tab Content -->
        <section id="documents-tab" class="tab-content active">
            <div class="glass-panel">
                <h2>Gestione Documenti</h2>

                <!-- Upload Section -->
                <div class="upload-section">
                    <div class="upload-methods">
                        <!-- File Upload -->
                        <div class="upload-method">
                            <h3>Carica File</h3>
                            <div class="drop-zone" id="dropZone">
                                <div class="drop-zone-content">
                                    <span class="upload-icon">üìÅ</span>
                                    <p>Trascina i file qui o clicca per selezionare</p>
                                    <p class="file-types">Supportati: .txt, .pdf, .doc, .docx</p>
                                    <input type="file" id="fileInput" multiple accept=".txt,.pdf,.doc,.docx" hidden>
                                </div>
                            </div>

                            <!-- Metadata Form -->
                            <div class="metadata-form" id="metadataForm" style="display: none;">
                                <h4>üìù Informazioni Aggiuntive</h4>

                                <!-- Notes Section -->
                                <div class="form-group">
                                    <label for="documentNotes">Note del Documento:</label>
                                    <textarea id="documentNotes" placeholder="Aggiungi note descrittive sul contenuto del documento..." rows="3"></textarea>
                                </div>

                                <!-- Details Section -->
                                <div class="form-group">
                                    <label>üè∑Ô∏è Tag Strutturati:</label>
                                    <div class="details-form">
                                        <div class="details-row">
                                            <input type="text" id="detailAuthor" placeholder="Autore" />
                                            <input type="text" id="detailType" placeholder="Tipo (es. code sample, documentation)" />
                                        </div>
                                        <div class="details-row">
                                            <input type="text" id="detailLicense" placeholder="Licenza (es. MIT, Apache)" />
                                            <input type="text" id="detailLanguages" placeholder="Linguaggi (es. .NET, Python)" />
                                        </div>
                                        <div class="details-row">
                                            <input type="text" id="detailServices" placeholder="Servizi (es. Azure SQL, OpenAI)" />
                                            <input type="text" id="detailTags" placeholder="Tag generici (separati da virgole)" />
                                        </div>
                                    </div>
                                </div>

                                <!-- Custom JSON -->
                                <div class="form-group">
                                    <label for="customDetails">JSON Personalizzato (opzionale):</label>
                                    <textarea id="customDetails" placeholder='{"custom_field": "value", "priority": 1}' rows="2"></textarea>
                                    <div class="json-hint">üí° Puoi inserire JSON personalizzato che verr√† unito con i tag strutturati</div>
                                </div>

                                <div class="metadata-actions">
                                    <button id="uploadWithMetadata" class="btn btn-primary">
                                        <span class="btn-icon">üì§</span>
                                        Carica con Metadati
                                    </button>
                                    <button id="skipMetadata" class="btn btn-secondary">
                                        <span class="btn-icon">‚è≠Ô∏è</span>
                                        Carica Senza Metadati
                                    </button>
                                    <button id="cancelUpload" class="btn btn-danger">
                                        <span class="btn-icon">‚ùå</span>
                                        Annulla
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Text Input -->
                        <div class="upload-method">
                            <h3>Indicizza Testo</h3>
                            <div class="text-input-section">
                                <input type="text" id="textTitle" placeholder="Titolo del documento" maxlength="255">
                                <textarea id="textContent" placeholder="Incolla qui il testo da indicizzare..." rows="8"></textarea>

                                <!-- Text Metadata -->
                                <div class="text-metadata">
                                    <div class="form-group">
                                        <label for="textNotes">Note:</label>
                                        <textarea id="textNotes" placeholder="Note descrittive per questo testo..." rows="2"></textarea>
                                    </div>

                                    <div class="form-group">
                                        <label>Tag Rapidi:</label>
                                        <div class="details-row">
                                            <input type="text" id="textAuthor" placeholder="Autore" />
                                            <input type="text" id="textType" placeholder="Tipo contenuto" />
                                            <input type="text" id="textTags" placeholder="Tag (separati da virgole)" />
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="textCustomDetails">JSON Aggiuntivo (opzionale):</label>
                                        <textarea id="textCustomDetails" placeholder='{"source": "documentation", "version": "1.0"}' rows="1"></textarea>
                                    </div>
                                </div>

                                <button id="indexTextBtn" class="btn btn-primary">
                                    <span class="btn-icon">üîç</span>
                                    Indicizza Testo con Metadati
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Documents List -->
                <div class="documents-section">
                    <div class="section-header">
                        <h3>Documenti Caricati</h3>
                        <button id="refreshBtn" class="btn btn-secondary">
                            <span class="btn-icon">üîÑ</span>
                            Aggiorna
                        </button>
                    </div>
                    <div class="documents-list" id="documentsList">
                        <div class="loading" id="documentsLoading">Caricamento documenti...</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chat Tab Content -->
        <section id="chat-tab" class="tab-content">
            <div class="glass-panel chat-container">
                <h2>Chat con AI</h2>

                <!-- Chat Messages -->
                <div class="chat-messages" id="chatMessages">
                    <div class="welcome-message">
                        <div class="message bot-message">
                            <div class="message-content">
                                <p>üëã Benvenuto nella chat RAG! Puoi farmi domande sui documenti che hai caricato.</p>
                                <p>Esempi di domande che puoi fare:</p>
                                <ul>
                                    <li>‚Ä¢ "Riassumi i contenuti principali"</li>
                                    <li>‚Ä¢ "Quali sono i requisiti di sistema?"</li>
                                    <li>‚Ä¢ "Trova informazioni su [argomento specifico]"</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chat Input -->
                <div class="chat-input-container">
                    <div class="chat-settings">
                        <label>
                            <input type="range" id="maxChunks" min="1" max="50" value="10">
                            Chunk massimi: <span id="maxChunksValue">10</span>
                        </label>
                        <label>
                            <input type="range" id="similarityThreshold" min="0.1" max="1" step="0.1" value="0.5">
                            Soglia similarit√†: <span id="similarityValue">0.5</span>
                        </label>
                    </div>
                    <div class="chat-input">
                        <textarea id="messageInput" placeholder="Scrivi la tua domanda..." rows="2"></textarea>
                        <button id="sendBtn" class="btn btn-primary">
                            <span class="btn-icon">üí¨</span>
                            Invia
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Status Bar -->
        <div class="status-bar" id="statusBar">
            <span id="statusText">Pronto</span>
            <span id="modeIndicator" class="mode-indicator">MOCK</span>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="js/app.js"></script>
</body>
</html>